{"version":3,"file":"my-base-element.mjs","sources":["../../index.mjs"],"sourcesContent":["/* global HTMLElement customElements  */\nclass MyBaseElement extends HTMLElement {\n  constructor () {\n    super()\n\n    this.state = this.initialState\n    this.loaded = false\n\n    var style = document.createElement('style')\n    var template = document.createElement('template')\n    style.textContent = this.style\n    template.innerHTML = this.template\n\n    this.shadow = this.attachShadow({\n      mode: 'open'\n    })\n    this.shadow.appendChild(style.cloneNode(true))\n    this.shadow.appendChild(template.content)\n  }\n\n  static define (name, child) {\n    try {\n      customElements.define(name, child)\n    } catch (err) {\n      console.log(err)\n      const h3 = document.createElement('h3')\n      h3.innerHTML = \"This site uses webcomponents which don't work in all browsers! Try this site in a browser that supports them!\"\n      document.body.appendChild(h3)\n    }\n  }\n\n  /* Beginning of Implementation. */\n\n  static get observedAttributes () {\n    return [] /* Array of observed attributes. [Array]. */\n  }\n  static get observedEvents () {\n    return [] /* Array of observed events [Array]. */\n  }\n\n  get initialState () {\n    return { /* Called in constructor [Object]. */ }\n  }\n\n  // LiveCircle\n  connected () { /* Triggered when the component is connected. */ }\n  rendered () { /* Triggered each time the component is rendered. */ }\n  disconnected () { /* Triggered when the component is disconnected. */ }\n\n  // Events\n  onState () { /* Called when state changes (state). */ }\n  onChange () { /* Called when attribute change (attrName, oldVal, newVal). */ }\n\n  // Rendering\n  get style () {\n    return `` /* Define a scoped/shadowed css. */\n  }\n  get template () {\n    return `[Empty Template]` /* Define a literal template. */\n  }\n\n  /* End of Implementation. */\n\n  eventHandler (event) {\n    switch (event.type) {\n      case 'click':\n        break\n      /* ... */\n      default:\n        break\n    }\n  }\n\n  connectedCallback () {\n    this.render()\n    this.connected()\n    this.loaded = true\n\n    // var oldAddEventListener = EventTarget.prototype.addEventListener\n\n    // EventTarget.prototype.addEventListener = function (eventName, eventHandler) {\n    //   oldAddEventListener.call(this, eventName, function (event) {\n    //     let eventNameCapitalized = `on${eventName.replace(/^\\w/, c => c.toUpperCase())}`\n    //     if (typeof this[eventNameCapitalized] === 'function') this[eventNameCapitalized](event)\n    //     this.eventHandler(event)\n    //   })\n    // }\n\n  // this.constructor.observedEvents.forEach(element => {\n  //   this.addEventListener(element)\n  // })\n  }\n\n  disconnectedCallback () {\n    this.disconnected()\n  }\n\n  render () {\n    this.shadow.querySelectorAll('DIV')[0].innerHTML = this.template\n    this.rendered()\n  }\n\n  setState (data, shouldRender) {\n    Object.entries(data).forEach((attr) => {\n      this.setAttribute(attr[0], attr[1])\n    })\n    const newState = Object.assign({}, this.state, data)\n    this.state = newState\n    this.onState(this.state)\n    if (shouldRender || this.loaded) this.render()\n  }\n\n  attributeChangedCallback (attrName, oldVal, newVal) {\n    const attrs = {}\n    attrs[attrName] = newVal\n    if (oldVal !== newVal) this.setState(attrs)\n    this.onChange(attrName, oldVal, newVal)\n  }\n}\n\nconst html = (literals, ...substitutions) => {\n  let result = ''\n\n  for (let i = 0; i < substitutions.length; i++) {\n    result += literals.raw[i]\n    result += substitutions[i]\n  }\n\n  result += literals[literals.length - 1]\n\n  return result\n}\n\nconst execute = (stringFunction, context) => {\n  var args = stringFunction.match('(?:{)(?:.*)(?:})')[0]\n  var funcName = stringFunction.substring(stringFunction.indexOf('> ') + 2, stringFunction.lastIndexOf('('))\n\n  const exec = (fstring, context) => {\n    var namespaces = fstring.split('.').slice(1)\n    var func = namespaces.pop()\n    for (var i = 0; i < namespaces.length; i++) {\n      context = context[namespaces[i]]\n    }\n    return context[func]\n  }\n\n  var argsToObject = args\n    .substring(args.lastIndexOf('{') + 1, args.lastIndexOf('}'))\n    .split(',')\n    .map(x => x.split(':').map(y => y.trim()))\n    .reduce((a, x) => {\n      a[x[0]] = x[1].indexOf(\"'\") === 0 ? x[1].substring(x[1].indexOf(\"'\") + 1, x[1].lastIndexOf(\"'\")) : exec(x[1], context)\n      return a\n    }, {})\n  var argsObject = Object.keys(argsToObject).map((k) => argsToObject[k])\n  if (typeof context[funcName] === 'function') {\n    return context[funcName](...argsObject)\n  } else {\n    throw new Error(`The function ${funcName} in not defined.`)\n  }\n}\n\nconst getTarget = (event, id) => {\n  event = event || window.event\n  var e = { event: event,\n    target: event.path ? event.path.find((each) => {\n      return each.id === id\n    }) : event.target\n  }\n  return e\n}\n\nconst clickTarget = (event, id, context) => {\n  var e = getTarget(event, id)\n  var stringFunction = e.target.attributes['onclick'].value\n  execute(stringFunction, context)\n}\n\nconst helpers = {execute, getTarget, clickTarget}\nexport { MyBaseElement, html, helpers }\n"],"names":[],"mappings":";;;EAAA;EACA,MAAM,aAAa,SAAS,WAAW,CAAC;EACxC,EAAE,WAAW,CAAC,GAAG;EACjB,IAAI,KAAK,GAAE;;EAEX,IAAI,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,aAAY;EAClC,IAAI,IAAI,CAAC,MAAM,GAAG,MAAK;;EAEvB,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,EAAC;EAC/C,IAAI,IAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,EAAC;EACrD,IAAI,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC,MAAK;EAClC,IAAI,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,SAAQ;;EAEtC,IAAI,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC;EACpC,MAAM,IAAI,EAAE,MAAM;EAClB,KAAK,EAAC;EACN,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,EAAC;EAClD,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,EAAC;EAC7C,GAAG;;EAEH,EAAE,OAAO,MAAM,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE;EAC9B,IAAI,IAAI;EACR,MAAM,cAAc,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,EAAC;EACxC,KAAK,CAAC,OAAO,GAAG,EAAE;EAClB,MAAM,OAAO,CAAC,GAAG,CAAC,GAAG,EAAC;EACtB,MAAM,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,EAAC;EAC7C,MAAM,EAAE,CAAC,SAAS,GAAG,gHAA+G;EACpI,MAAM,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAC;EACnC,KAAK;EACL,GAAG;;EAEH;;EAEA,EAAE,WAAW,kBAAkB,CAAC,GAAG;EACnC,IAAI,OAAO,EAAE;EACb,GAAG;EACH,EAAE,WAAW,cAAc,CAAC,GAAG;EAC/B,IAAI,OAAO,EAAE;EACb,GAAG;;EAEH,EAAE,IAAI,YAAY,CAAC,GAAG;EACtB,IAAI,OAAO,yCAAyC;EACpD,GAAG;;EAEH;EACA,EAAE,SAAS,CAAC,GAAG,oDAAoD;EACnE,EAAE,QAAQ,CAAC,GAAG,wDAAwD;EACtE,EAAE,YAAY,CAAC,GAAG,uDAAuD;;EAEzE;EACA,EAAE,OAAO,CAAC,GAAG,4CAA4C;EACzD,EAAE,QAAQ,CAAC,GAAG,kEAAkE;;EAEhF;EACA,EAAE,IAAI,KAAK,CAAC,GAAG;EACf,IAAI,OAAO,CAAC,CAAC;EACb,GAAG;EACH,EAAE,IAAI,QAAQ,CAAC,GAAG;EAClB,IAAI,OAAO,CAAC,gBAAgB,CAAC;EAC7B,GAAG;;EAEH;;EAEA,EAAE,YAAY,CAAC,CAAC,KAAK,EAAE;EACvB,IAAI,QAAQ,KAAK,CAAC,IAAI;EACtB,MAAM,KAAK,OAAO;EAClB,QAAQ,KAAK;EACb;EACA,MAAM;EACN,QAAQ,KAAK;EACb,KAAK;EACL,GAAG;;EAEH,EAAE,iBAAiB,CAAC,GAAG;EACvB,IAAI,IAAI,CAAC,MAAM,GAAE;EACjB,IAAI,IAAI,CAAC,SAAS,GAAE;EACpB,IAAI,IAAI,CAAC,MAAM,GAAG,KAAI;;EAEtB;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA,GAAG;;EAEH,EAAE,oBAAoB,CAAC,GAAG;EAC1B,IAAI,IAAI,CAAC,YAAY,GAAE;EACvB,GAAG;;EAEH,EAAE,MAAM,CAAC,GAAG;EACZ,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,SAAQ;EACpE,IAAI,IAAI,CAAC,QAAQ,GAAE;EACnB,GAAG;;EAEH,EAAE,QAAQ,CAAC,CAAC,IAAI,EAAE,YAAY,EAAE;EAChC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;EAC3C,MAAM,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,EAAC;EACzC,KAAK,EAAC;EACN,IAAI,MAAM,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,EAAC;EACxD,IAAI,IAAI,CAAC,KAAK,GAAG,SAAQ;EACzB,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAC;EAC5B,IAAI,IAAI,YAAY,IAAI,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,GAAE;EAClD,GAAG;;EAEH,EAAE,wBAAwB,CAAC,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE;EACtD,IAAI,MAAM,KAAK,GAAG,GAAE;EACpB,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,OAAM;EAC5B,IAAI,IAAI,MAAM,KAAK,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAC;EAC/C,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAC;EAC3C,GAAG;EACH,CAAC;;AAED,AAAK,QAAC,IAAI,GAAG,CAAC,QAAQ,EAAE,GAAG,aAAa,KAAK;EAC7C,EAAE,IAAI,MAAM,GAAG,GAAE;;EAEjB,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACjD,IAAI,MAAM,IAAI,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAC;EAC7B,IAAI,MAAM,IAAI,aAAa,CAAC,CAAC,EAAC;EAC9B,GAAG;;EAEH,EAAE,MAAM,IAAI,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAC;;EAEzC,EAAE,OAAO,MAAM;EACf,EAAC;;EAED,MAAM,OAAO,GAAG,CAAC,cAAc,EAAE,OAAO,KAAK;EAC7C,EAAE,IAAI,IAAI,GAAG,cAAc,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAC;EACxD,EAAE,IAAI,QAAQ,GAAG,cAAc,CAAC,SAAS,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,cAAc,CAAC,WAAW,CAAC,GAAG,CAAC,EAAC;;EAE5G,EAAE,MAAM,IAAI,GAAG,CAAC,OAAO,EAAE,OAAO,KAAK;EACrC,IAAI,IAAI,UAAU,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,EAAC;EAChD,IAAI,IAAI,IAAI,GAAG,UAAU,CAAC,GAAG,GAAE;EAC/B,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EAChD,MAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,EAAC;EACtC,KAAK;EACL,IAAI,OAAO,OAAO,CAAC,IAAI,CAAC;EACxB,IAAG;;EAEH,EAAE,IAAI,YAAY,GAAG,IAAI;EACzB,KAAK,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;EAChE,KAAK,KAAK,CAAC,GAAG,CAAC;EACf,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC9C,KAAK,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK;EACtB,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,EAAC;EAC5H,MAAM,OAAO,CAAC;EACd,KAAK,EAAE,EAAE,EAAC;EACV,EAAE,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,YAAY,CAAC,CAAC,CAAC,EAAC;EACxE,EAAE,IAAI,OAAO,OAAO,CAAC,QAAQ,CAAC,KAAK,UAAU,EAAE;EAC/C,IAAI,OAAO,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,UAAU,CAAC;EAC3C,GAAG,MAAM;EACT,IAAI,MAAM,IAAI,KAAK,CAAC,CAAC,aAAa,EAAE,QAAQ,CAAC,gBAAgB,CAAC,CAAC;EAC/D,GAAG;EACH,EAAC;;EAED,MAAM,SAAS,GAAG,CAAC,KAAK,EAAE,EAAE,KAAK;EACjC,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,CAAC,MAAK;EAC/B,EAAE,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK;EACxB,IAAI,MAAM,EAAE,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK;EACnD,MAAM,OAAO,IAAI,CAAC,EAAE,KAAK,EAAE;EAC3B,KAAK,CAAC,GAAG,KAAK,CAAC,MAAM;EACrB,IAAG;EACH,EAAE,OAAO,CAAC;EACV,EAAC;;EAED,MAAM,WAAW,GAAG,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,KAAK;EAC5C,EAAE,IAAI,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,EAAE,EAAC;EAC9B,EAAE,IAAI,cAAc,GAAG,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,MAAK;EAC3D,EAAE,OAAO,CAAC,cAAc,EAAE,OAAO,EAAC;EAClC,EAAC;;AAED,AAAK,QAAC,OAAO,GAAG,CAAC,OAAO,EAAE,SAAS,EAAE,WAAW,CAAC;;;;;;;;;;;;"}